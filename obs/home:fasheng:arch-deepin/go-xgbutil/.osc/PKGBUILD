# Maintainer: Josip Ponjavic <josipponjavic at gmail dot com>
# Contributor: 

pkgname=go-xgbutil
pkgver=git20140311~800bc6c
pkgrel=3
pkgdesc='xgbutil is a utility library designed to work with the X Go Binding.'
arch=('i686' 'x86_64')
url="https://github.com/BurntSushi/xgbutil"
license=('GPL2')
depends=('go>=1.3' 'go-xgb' 'golang-graphics-go' 'golang-jamslam-freetype-go')
makedepends=('xcb-proto')
groups=('deepin')
options=(staticlibs)
source=("xgbutil-${pkgver}.tar.xz")
sha256sums=('SKIP')

build(){
  cd "$srcdir"
  
  mkdir -p go-xgbutil-build/src/github.com/BurntSushi/
  cp -r xgbutil-${pkgver} go-xgbutil-build/src/github.com/BurntSushi/xgbutil/
  rm -rf go-xgbutil-build/src/github.com/BurntSushi/xgbutil/.git
  # autobuild go
  #cd "$srcdir"/go-xgbutil-build/src/github.com/BurntSushi/xgbutil
  #cd "$srcdir"/go-xgbutil-build/src/github.com/BurntSushi/xgbutil && make
  cd go-xgbutil-build && GOPATH=`pwd` go install github.com/BurntSushi/xgbutil
  #GOPATH="$srcdir"/go-xgbutil-build go install github.com/BurntSushi/xgbutil
  cd "$srcdir"/go-xgbutil-build && GOPATH=`pwd` go install github.com/BurntSushi/xgbutil/{ewmh,gopher,icccm,keybind,motif,mousebind,xcursor,xevent,xgraphics,xinerama,xprop,xrect,xwindow}
  
  #GOPATH="$srcdir"/go-xgbutil-build go install github.com/BurntSushi/xgbutil/{ewmh,gopher,icccm,keybind,motif,mousebind,xcursor,xevent,xgraphics,xinerama,xprop,xrect,xwindow}
}

package() {

  install -dm 755 "${pkgdir}"/usr/lib/go/{pkg,src/pkg}
  cp -rf "$srcdir"/go-xgbutil-build/src/* "${pkgdir}"/usr/lib/go/src/pkg/
  cp -rf "$srcdir"/go-xgbutil-build/pkg/* "${pkgdir}"/usr/lib/go/pkg/
}
