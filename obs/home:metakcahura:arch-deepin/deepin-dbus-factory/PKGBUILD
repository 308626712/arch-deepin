# Maintainer: Josip Ponjavic <josipponjavic at gmail dot com>
# Maintainer: Xu Fasheng <fasheng.xu[AT]gmail.com>

pkgbase=deepin-dbus-factory
pkgname=('dde-go-dbus-factory'
         'dde-qml-dbus-factory')
pkgver=14.12.20150715104229
_srcdirname=dbus-factory-14.12+git20150715104229~369bc351ee
pkgrel=2
arch=('i686' 'x86_64')
url="https://github.com/linuxdeepin/dbus-factory"
license=('GPL3')
makedepends=('go-dlib' 'qt5-webkit' 'qt5-declarative' 'python2'
             'deepin-dbus-generator')
groups=('deepin')
source=("http://ftp5.gwdg.de/pub/linux/linuxdeepin/packages/pool/main/d/dbus-factory/dbus-factory_14.12+git20150715104229~369bc351ee.tar.gz"
        "fix-arch.patch")
sha256sums=('07b57fbf22223252edd7f0d4d4a198809a69e9dd9fbffce793af7ad5fbd058cc'
            'SKIP')

build() {
  cd "${_srcdirname}"

  patch -p1 -i ../fix-arch.patch

  make -j8
}

package_dde-qml-dbus-factory() {
  pkgdesc='QML DBus factory for DDE'
  depends=('qt5-declarative')

  cd "${_srcdirname}"

  make DESTDIR="${pkgdir}" install-qml
}

package_dde-go-dbus-factory() {
  pkgdesc='Go-lang DBus factory for DDE'

  cd "${_srcdirname}"

  make DESTDIR="${pkgdir}" install-golang
}
