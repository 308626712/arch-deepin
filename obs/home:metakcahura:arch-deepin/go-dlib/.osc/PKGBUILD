# Maintainer: Josip Ponjavic <josipponjavic at gmail dot com>
# Contributor: 

pkgname=go-dlib
pkgver=git20140522~3948504
pkgrel=1
pkgdesc='Go-lang bingdings for dlib'
arch=('i686' 'x86_64')
url="https://github.com/linuxdeepin/go-lib"
license=('GPL2')
depends=('glib2')
makedepends=('go>=1.3' 'gettext' 'gdk-pixbuf2' 'golang-gocheck' 'libpulse')
groups=('deepin')
options=(staticlibs)
source=("${pkgname}-${pkgver}.tar.xz")
sha256sums=('SKIP')

build(){
  cd "$srcdir"
  
  mkdir -p ${pkgname}-build/src/pkg.linuxdeepin.com/lib
  cp -r ${pkgname}-${pkgver}/* ${pkgname}-build/src/pkg.linuxdeepin.com/lib/
  rm -rf ${pkgname}-build/src/pkg.linuxdeepin.com/lib/.git
  cd ${pkgname}-build && GOPATH=`pwd` go install pkg.linuxdeepin.com/lib
  cd $srcdir/${pkgname}-build && GOPATH=`pwd` go install pkg.linuxdeepin.com/lib/{dbus,gettext,gio-2.0,glib-2.0,gobject-2.0,graphic,logger,pinyin,proxy,pulse,utils}
}

package() {
  cd "$srcdir"

  install -dm 755 "${pkgdir}"/usr/lib/go/{pkg,src/pkg}
  
  cp -r ${pkgname}-build/pkg/* "${pkgdir}"/usr/lib/go/pkg/
  cp -r ${pkgname}-build/src/* "${pkgdir}"/usr/lib/go/src/pkg/
}
