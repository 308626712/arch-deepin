# Maintainer: Josip Ponjavic <josipponjavic at gmail dot com>
# Contributor: 

pkgname=golang-jamslam-freetype-go
_pkgver=0.0
_pkgvergit=~git20140306
pkgver=${_pkgver}${_pkgvergit}
pkgrel=3
pkgdesc='File system notification for GO'
arch=('i686' 'x86_64')
url="https://github.com/BurntSushi/xgb"
license=('GPL2')
depends=('go>=1.3rc2')
groups=('deepin')
options=(staticlibs)
source=("http://test.packages.linuxdeepin.com/deepin/pool/main/g/${pkgname}/${pkgname}_${pkgver}.orig.tar.xz")
sha256sums=('028b753388ec2d54105ae3c2713cae4075d9a578a39648c38b05105ac65711a4')

build(){
  cd "$srcdir"
  
  mkdir -p golang-jamslam-freetype-go-build/src/code.google.com/p/jamslam-freetype-go/
  cp -r jamslam-freetype-go/freetype golang-jamslam-freetype-go-build/src/code.google.com/p/jamslam-freetype-go/
  # autobuild go
  cd golang-jamslam-freetype-go-build && GOPATH=`pwd` go install code.google.com/p/jamslam-freetype-go/freetype
  # build truetype submodule
  cp -r "$srcdir"/jamslam-freetype-go/freetype/truetype "$srcdir"/golang-jamslam-freetype-go-build/src/code.google.com/p/jamslam-freetype-go/freetype
  cd "$srcdir"/golang-jamslam-freetype-go-build && GOPATH=`pwd` go install code.google.com/p/jamslam-freetype-go/freetype/truetype
}

package() {

  mkdir -p "${pkgdir}"/usr/lib/go/{pkg,src/pkg/code.google.com/p/jamslam-freetype-go}
  cp -r "$srcdir"/golang-jamslam-freetype-go-build/src/code.google.com/p/jamslam-freetype-go/* "${pkgdir}"/usr/lib/go/src/pkg/code.google.com/p/jamslam-freetype-go
  cp -r "$srcdir"/golang-jamslam-freetype-go-build/pkg/* "${pkgdir}"/usr/lib/go/pkg/
}
